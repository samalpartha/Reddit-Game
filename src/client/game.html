<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Daily Verdict</title>
    <link rel="stylesheet" href="game.css" />
    <script type="module" src="game.ts"></script>
  </head>
  <body>
    <div class="game-app" id="game-app">

      <!-- ‚ïê‚ïê‚ïê Loading State ‚ïê‚ïê‚ïê -->
      <div class="view" id="view-loading">
        <div class="loading-spinner">
          <div class="gavel-icon">‚öñÔ∏è</div>
          <p class="loading-text">Loading today's case...</p>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Open State: Vote ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-open">
        <!-- Top Bar -->
        <div class="top-bar">
          <div class="top-bar-left">
            <span class="brand-icon">‚öñÔ∏è</span>
            <span class="brand-name">Daily Verdict</span>
          </div>
          <div class="top-bar-right">
            <button class="icon-btn" id="btn-archive" title="Archive">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M3 5h14M5 5v10a2 2 0 002 2h6a2 2 0 002-2V5M8 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <button class="icon-btn" id="btn-submit-case" title="Submit a Case">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M10 4v12M4 10h12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
          </div>
        </div>

        <!-- Case Card -->
        <div class="case-card">
          <div class="case-header">
            <span class="case-date" id="open-date"></span>
            <span class="case-countdown" id="open-countdown"></span>
          </div>
          <h2 class="case-title" id="open-title"></h2>
          <span class="case-source" id="open-source" style="display:none">Community submitted</span>
          <p class="case-text" id="open-text"></p>
          <p class="case-voters" id="open-voters">0 votes so far</p>
        </div>

        <!-- Verdict Picker -->
        <div class="picker-section">
          <h3 class="picker-label">Your Verdict</h3>
          <p class="picker-hint">What's the right call here?</p>
          <div class="verdict-grid" id="verdict-grid">
            <!-- Buttons populated by JS -->
          </div>
        </div>

        <!-- Prediction Picker -->
        <div class="picker-section">
          <h3 class="picker-label">Your Prediction</h3>
          <p class="picker-hint">What will the majority say?</p>
          <div class="prediction-grid" id="prediction-grid">
            <!-- Buttons populated by JS -->
          </div>
        </div>

        <!-- Sticky Submit Bar -->
        <div class="sticky-submit" id="sticky-submit">
          <button class="submit-btn" id="submit-vote-btn" disabled>
            <span id="submit-vote-text">Pick your verdict and prediction</span>
          </button>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Voted State: Waiting ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-voted">
        <div class="top-bar">
          <div class="top-bar-left">
            <span class="brand-icon">‚öñÔ∏è</span>
            <span class="brand-name">Daily Verdict</span>
          </div>
          <div class="top-bar-right">
            <button class="icon-btn" id="btn-archive-2" title="Archive">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M3 5h14M5 5v10a2 2 0 002 2h6a2 2 0 002-2V5M8 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
          </div>
        </div>

        <div class="voted-card">
          <div class="voted-check">‚úì</div>
          <h2 class="voted-title">Vote Submitted!</h2>
          <p class="voted-subtitle">Your picks are locked in. Results hidden until reveal.</p>

          <div class="your-picks">
            <div class="pick-row">
              <span class="pick-label">Your Verdict</span>
              <span class="pick-value" id="voted-verdict"></span>
            </div>
            <div class="pick-row">
              <span class="pick-label">Your Prediction</span>
              <span class="pick-value" id="voted-prediction"></span>
            </div>
          </div>

          <div class="reveal-countdown-card">
            <p class="reveal-countdown-label">Results reveal in</p>
            <p class="reveal-countdown-value" id="voted-countdown"></p>
          </div>

          <div class="comment-cta">
            <p class="comment-cta-text">Make your case in the comments!</p>
            <p class="comment-cta-hint">Persuading others can earn you an Influence Bonus (+15 pts)</p>
            <button class="comment-btn" id="btn-commented">I Left a Comment</button>
          </div>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Closed State: Missed Voting ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-closed">
        <div class="top-bar">
          <div class="top-bar-left">
            <span class="brand-icon">‚öñÔ∏è</span>
            <span class="brand-name">Daily Verdict</span>
          </div>
          <div class="top-bar-right">
            <button class="icon-btn" id="btn-archive-closed" title="Archive">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M3 5h14M5 5v10a2 2 0 002 2h6a2 2 0 002-2V5M8 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
          </div>
        </div>

        <div class="closed-card">
          <div class="closed-icon">üîí</div>
          <h2 class="closed-title-heading">Voting Closed</h2>
          <p class="closed-subtitle">You missed the voting window for this case.</p>

          <div class="case-card" style="margin:0">
            <h3 class="case-title" id="closed-title"></h3>
            <p class="case-text" id="closed-text"></p>
          </div>

          <div class="reveal-countdown-card" style="margin-top:20px">
            <p class="reveal-countdown-label">Results reveal in</p>
            <p class="reveal-countdown-value" id="closed-countdown"></p>
          </div>

          <p class="closed-hint">Come back tomorrow to vote on the next case!</p>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Revealed State ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-revealed">
        <div class="top-bar">
          <div class="top-bar-left">
            <span class="brand-icon">‚öñÔ∏è</span>
            <span class="brand-name">Daily Verdict</span>
          </div>
          <div class="top-bar-right">
            <button class="icon-btn" id="btn-archive-3" title="Archive">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M3 5h14M5 5v10a2 2 0 002 2h6a2 2 0 002-2V5M8 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <button class="icon-btn gm-reveal-btn" id="btn-gm-reveal" title="GameMaker Reveal">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M4 8l6-4 6 4v8l-6 4-6-4V8z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/><path d="M10 4v16M4 8l12 8M16 8L4 16" stroke="currentColor" stroke-width="1" stroke-linejoin="round" opacity="0.5"/></svg>
            </button>
          </div>
        </div>

        <!-- Majority Stamp -->
        <div class="verdict-stamp" id="verdict-stamp">
          <div class="stamp-ring">
            <div class="stamp-label" id="stamp-label">RIGHT CALL</div>
          </div>
          <p class="stamp-voters" id="stamp-voters">0 voters</p>
        </div>

        <!-- Results Chart -->
        <div class="results-chart" id="results-chart">
          <!-- Bars populated by JS -->
        </div>

        <!-- Score Breakdown -->
        <div class="score-card" id="score-card">
          <h3 class="score-title">Your Score</h3>
          <div class="score-total" id="score-total">0</div>
          <div class="score-breakdown" id="score-breakdown">
            <!-- Rows populated by JS -->
          </div>
        </div>

        <!-- Streak -->
        <div class="streak-card" id="streak-card">
          <div class="streak-flame">üî•</div>
          <div class="streak-info">
            <span class="streak-count" id="streak-count">0</span>
            <span class="streak-label">day streak</span>
          </div>
          <div class="streak-best">
            Best: <span id="streak-best">0</span>
          </div>
        </div>

        <!-- Leaderboard -->
        <div class="leaderboard-card" id="leaderboard-card">
          <div class="lb-tabs">
            <button class="lb-tab active" id="lb-tab-daily" data-tab="daily">Today</button>
            <button class="lb-tab" id="lb-tab-weekly" data-tab="weekly">This Week</button>
          </div>
          <div class="lb-list" id="lb-list">
            <!-- Rows populated by JS -->
          </div>
          <div class="lb-me" id="lb-me"></div>
          <div class="lb-list hidden" id="lb-weekly-list">
            <!-- Weekly rows populated by JS -->
          </div>
        </div>

        <!-- Actions -->
        <div class="reveal-actions">
          <button class="action-btn" id="btn-submit-case-2" title="Submit a Case">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M10 4v12M4 10h12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Submit a Case
          </button>
          <button class="action-btn mod-only hidden" id="btn-mod-queue" title="Mod Queue">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M9 5H7a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M13 3l4 4-7 7H6v-4l7-7z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Mod Queue
          </button>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Archive State ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-archive">
        <div class="top-bar">
          <div class="top-bar-left">
            <button class="icon-btn" id="btn-back-archive" title="Back">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 4L7 10L13 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <span class="brand-name">Past Cases</span>
          </div>
        </div>
        <div class="archive-list" id="archive-list">
          <!-- Populated by JS -->
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Submit Case State ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-submit">
        <div class="top-bar">
          <div class="top-bar-left">
            <button class="icon-btn" id="btn-back-submit" title="Back">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 4L7 10L13 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <span class="brand-name">Submit a Case</span>
          </div>
        </div>

        <div class="submit-form">
          <div class="form-group">
            <label class="form-label" for="submit-title">Title (optional)</label>
            <input type="text" id="submit-title" class="form-input" placeholder="Short, catchy title" maxlength="80" />
          </div>

          <div class="form-group">
            <label class="form-label" for="submit-text">The Scenario</label>
            <textarea id="submit-text" class="form-textarea" placeholder="Describe a moral dilemma or social situation (30-600 characters). Include a clear decision point that people can debate." maxlength="600" rows="6"></textarea>
            <div class="form-char-count"><span id="char-count">0</span>/600</div>
          </div>

          <div class="form-checkbox-group">
            <label class="form-checkbox">
              <input type="checkbox" id="submit-agree" />
              <span class="checkmark"></span>
              <span class="checkbox-text">No real names, locations, or personal data.</span>
            </label>
          </div>

          <button class="submit-case-btn" id="submit-case-btn" disabled>Submit for Review</button>
          <p class="submit-hint">Submissions are reviewed by moderators before being scheduled.</p>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Mod Queue State ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-mod">
        <div class="top-bar">
          <div class="top-bar-left">
            <button class="icon-btn" id="btn-back-mod" title="Back">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 4L7 10L13 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <span class="brand-name">Mod Queue</span>
          </div>
        </div>
        <div class="mod-list" id="mod-list">
          <!-- Populated by JS -->
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Error State ‚ïê‚ïê‚ïê -->
      <div class="view hidden" id="view-error">
        <div class="error-card">
          <div class="error-icon">üòî</div>
          <h2 class="error-title">Something went wrong</h2>
          <p class="error-message" id="error-message">Failed to load the game.</p>
          <button class="retry-btn" id="retry-btn">Try Again</button>
        </div>
      </div>
    </div>
  </body>
</html>
